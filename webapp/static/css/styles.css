/* =====================================================
   VARIABLES
===================================================== */
:root{
  --blue-800:#2C3E50;
  --blue-500:#4A6A8C;
  --blue-50:#f1f6fc;
  --green:#1ABC9C;
  --green-dark:#169b81;
  --grey-100:#f5f7fa;
  --grey-200:#e5e8eb;
  --grey-600:#6b7b8a;
  --bubble-user:#6fa8ff;
  --radius:10px;
  --sidebar-w:210px;
  --sidebar-w-collapsed:56px;
  --trans:200ms cubic-bezier(.4,.0,.2,1);
  font-family:'Inter','Roboto',system-ui,sans-serif;
  font-size:14px;
}

*{box-sizing:border-box;margin:0;padding:0}

/* =====================================================
   LAYOUT
===================================================== */
body{display:flex;height:100vh;overflow:hidden;color:#202124;background:var(--grey-100);}

.hidden{ display:none !important; }

/* ---------- SIDEBAR ---------- */
.sidebar{
  width:var(--sidebar-w);
  background:var(--blue-500);
  color:#fff;
  padding:1rem .9rem;
  display:flex;
  flex-direction:column;
  gap:1rem;
  transition:width var(--trans);
}
.sidebar.collapsed{width:var(--sidebar-w-collapsed);}
.sidebar .brand{font-size:1.35rem;font-weight:600;line-height:1;}
.sidebar .brand span{font-weight:300;}
.btn-green{
  background:var(--green);
  border:none;color:#fff;font-weight:600;
  padding:.55rem .9rem;border-radius:24px;
  display:flex;align-items:center;gap:.4rem;
  cursor:pointer;transition:background var(--trans),box-shadow var(--trans);
}
.btn-green:hover{background:var(--green-dark);}
.btn-green:active{box-shadow:inset 0 2px 5px rgba(0,0,0,.25);}
.full-width{width:100%;}
.chat-nav{display:flex;flex-direction:column;gap:.4rem;}
.group-label{font-size:.7rem;opacity:.65;margin:.8rem 0 .3rem;}
.chat-item{
  display:flex;align-items:center;gap:.4rem;
  padding:.35rem .3rem;border-radius:6px;
  color:rgba(255,255,255,.9);text-decoration:none;
  transition:background var(--trans),color var(--trans);
}
.chat-item:hover{background:rgba(0,0,0,.15);}
.chat-item.active{border-left:3px solid var(--green);background:rgba(0,0,0,.25);}
.sidebar.collapsed .chat-item span,
.sidebar.collapsed .group-label,
.sidebar.collapsed .btn-green span{display:none;}

/* ---------- MAIN COL ---------- */
.main-col{flex:1;display:flex;flex-direction:column;height:100%;overflow:hidden;}
.topbar{
  height:60px;background:var(--blue-800);
  display:flex;align-items:center;padding:0 1rem;color:#fff;
}
.burger{
  background:none;border:none;color:#fff;font-size:1.2rem;cursor:pointer;
  display:none; /* visible con media-query cuando la sidebar colapse */
}
.avatar{width:34px;height:34px;border-radius:50%;cursor:pointer;transition:filter var(--trans);}
.avatar:hover{filter:brightness(1.15);}
.spacer{flex:1;}
.main-content{flex:1;padding:1.5rem;overflow-y:auto;}

/* =====================================================
   CHAT STREAM
===================================================== */
.chat-stream{max-width:1080px;margin:0 auto;display:flex;flex-direction:column;gap:18px;}
@keyframes bubble-in{from{transform:translateY(12px);opacity:0;}to{transform:none;opacity:1;}}

/* ---------- burbuja usuario ---------- */
.bubble.user{
  margin-left:auto;
  border-radius:20px;
  background:var(--bubble-user);
  color:#fff;
  padding:1rem 1.4rem;
  max-width:72%;
  animation:bubble-in .25s ease-out;
}

/* ---------- burbuja bot ---------- */
.bubble.bot{display:flex;gap:18px;animation:bubble-in .25s ease-out;}

.bubble.bot .bot-tag{
  width:32px;height:32px;border-radius:50%;
  background:var(--blue-800);color:#fff;font-weight:600;
  display:flex;align-items:center;justify-content:center;
  flex-shrink:0;user-select:none;
}

.bubble.bot .bot-card{
  background:#d7dade;
  border-radius:var(--radius);
  padding:1.4rem 1.6rem;
  display:flex;flex-direction:column;gap:1rem;
  max-width:650px;
  box-shadow:0 2px 6px rgba(0,0,0,.07);
}

/* ---------- contenido interno ---------- */
.bot-card pre{
  background:#f1f3f5;
  padding:.7rem .9rem;
  border-radius:6px;
  white-space:pre-wrap;      /* evita overflow horizontal */
  word-break:break-word;
}

.bot-card table{
  width:100%;
  border-collapse:collapse;
  font-size:.86rem;
  background:#fff;
  table-layout:fixed;
  overflow-x:auto;
}
.bot-card th,.bot-card td{border:1px solid #ccd0d4;padding:5px 8px;}
.bot-card th{background:#f9fafb;font-weight:600;text-align:left;}
.bot-card td a{color:var(--green);word-break:break-all;}
.summary-title{font-weight:600;margin-bottom:.2rem;}
.table-wrapper{
  max-width:100%;
  overflow-x:auto;             /* ‚≠ê scroll horizontal si se pasa del ancho */
}
.table-wrapper table{
  min-width:640px;             /* para que aparezca el scroll antes de romper */
}
.bot-card th, .bot-card td{
  word-break:break-word;       /* corta URLs muy largas */
}
.dl-link{
  display:inline-flex;align-items:center;gap:.4rem;
  margin-top:.5rem;font-size:.85rem;font-weight:600;
  color:var(--blue-800);text-decoration:none;
  transition:color var(--trans);
}
.dl-link:hover{color:var(--green);}

/* =====================================================
   INPUT BAR
===================================================== */
.chat-input{
  position:fixed;left:var(--sidebar-w);right:0;bottom:0;
  display:flex;gap:.6rem;background:#fff;border-top:1px solid #d0d4d9;
  padding:.7rem 1.2rem;transition:left var(--trans);
}
.sidebar.collapsed ~ .main-col .chat-input{left:var(--sidebar-w-collapsed);}
.chat-input textarea{
  flex:1;border:none;background:#d6dadf;border-radius:4px;
  padding:.65rem .8rem;font-family:inherit;font-size:1rem;resize:none;min-height:46px;
  transition:box-shadow var(--trans);
}
.chat-input textarea:focus{outline:none;box-shadow:0 0 0 2px var(--green);}
.send-btn{
  background:var(--green);border:none;width:60px;border-radius:4px;color:#fff;
  font-size:1.2rem;cursor:pointer;display:flex;align-items:center;justify-content:center;
  transition:background var(--trans),transform var(--trans);
}
.send-btn:hover{background:var(--green-dark);}
.send-btn:active{transform:scale(.93);}

/* =====================================================
   STATUS & ETL
===================================================== */
.status-info{font-size:.9rem;color:var(--grey-600);text-align:center;margin:1rem 0;}
.hidden{display:none;}

.etl-log{white-space:pre-line;background:#fff;border:1px solid #d0d4d9;padding:1rem;border-radius:var(--radius);margin-top:1rem;font-size:.9rem;}
.pulse{animation:pulse 1.4s infinite ease-in-out;}
@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(26,188,156,.5);}50%{box-shadow:0 0 0 7px rgba(26,188,156,0);}}

/* --- enlace ETL en sidebar & topbar --- */
.etl-link{margin-bottom:.6rem;font-weight:600;}
.etl-topbtn{
  margin-left:1rem;color:#fff;font-size:1.25rem;
  display:none;               /* visible solo al colapsar */
  transition:color var(--trans);
}
.etl-topbtn:hover{color:var(--green);}
.chat-item.etl-link.active,
.etl-topbtn.active{color:var(--green);}

@media(max-width:992px){
  .etl-topbtn{display:inline-block;}
}

/* ---------- Overlay ETL ---------- */
.overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.45);
  display:flex;align-items:center;justify-content:center;
  z-index:2000;
}
.overlay-card{
  background:#fff;padding:2rem 2.5rem;border-radius:10px;
  width:380px;max-width:90%;
  display:flex;flex-direction:column;gap:1.3rem;
  box-shadow:0 4px 16px rgba(0,0,0,.25);
}
.bar-back{
  height:14px;background:#e4e7eb;border-radius:7px;overflow:hidden;
}
.bar-front{
  height:100%;background:var(--green);width:0%;
  transition:width .35s ease;
}
.etl-log{
  max-height:220px;overflow-y:auto;
  background:#f9fafb;border:1px solid #d0d4d9;
  padding:.8rem;border-radius:6px;font-size:.88rem;
  white-space:pre-wrap;
}

.etl-console{
  margin-top:1rem;background:#fff;border:1px solid #d0d4d9;
  padding:1rem;border-radius:6px;max-height:260px;overflow-y:auto;
  white-space:pre-wrap;font-size:.88rem;
}

/* =====================================================
   RESPONSIVE
===================================================== */
@media(max-width:992px){
  .sidebar.collapsed{width:var(--sidebar-w-collapsed);}
  #sidebar{position:fixed;z-index:1000;height:100%;left:0;top:0;}
  .burger{display:inline-block;margin-right:1rem;}
  body.sidebar-open #sidebar{transform:translateX(0);}
  body:not(.sidebar-open) #sidebar{transform:translateX(-100%);transition:transform var(--trans);}
  body.sidebar-open::after{
    content:"";position:fixed;inset:0;background:rgba(0,0,0,.35);z-index:900;
  }
  .chat-input{left:0;}
}

@media(max-width:768px){
  .chat-stream{padding:0 6px;}
  .bot-card table{display:block;overflow-x:auto;}
}